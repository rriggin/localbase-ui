<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Ads Performance - LocalBase</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <style>
        :root {
            --lb-blue: #5F8DFF;
            --lb-black: #1E1E2E;
            --lb-gray-dark: #2A2A3C;
            --lb-gray-medium: #383850;
            --lb-white: #FFFFFF;
            --lb-green: #5DD6C7;
            --lb-orange: #FFB366;
            --lb-purple: #B794F6;
            --text-color: var(--lb-white);
            --secondary-text: #B8B8D0;
            --border-color: #404060;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--lb-black);
            color: var(--text-color);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 32px;
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--secondary-text);
            font-size: 16px;
        }

        .chart-card {
            background-color: var(--lb-gray-dark);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 24px;
            margin-bottom: 20px;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            transition: background-color 0.2s;
        }

        .legend-item:hover {
            background-color: var(--lb-gray-medium);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        .legend-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-color);
        }

        #chart {
            width: 100%;
            height: 400px;
            background-color: var(--lb-gray-medium);
            border-radius: 8px;
        }

        .line {
            fill: none;
            stroke-width: 3;
        }

        .axis {
            font-size: 12px;
        }

        .axis text {
            fill: var(--secondary-text);
        }

        .axis path,
        .axis line {
            stroke: var(--border-color);
        }

        .grid-line {
            stroke: var(--border-color);
            stroke-width: 1;
            opacity: 0.3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üöÅ Google Ads Performance</h1>
            <p class="subtitle">Campaign spend over time - LocalBase Analytics</p>
        </div>
        
        <div class="chart-card">
            <div class="legend" id="legend"></div>
            <svg id="chart"></svg>
        </div>
    </div>

    <script>
        // Google Ads data
        const data = [
            {"date": "2025-05-03", "roofmaxx_kc": 127.73, "kc_restoration": 67.67, "storm_damage": 174.88, "maintenance": 66.15, "commercial": 87.49},
            {"date": "2025-05-04", "roofmaxx_kc": 110.63, "kc_restoration": 86.67, "storm_damage": 126.29, "maintenance": 68.08, "commercial": 96.92},
            {"date": "2025-05-05", "roofmaxx_kc": 153.56, "kc_restoration": 143.58, "storm_damage": 258.25, "maintenance": 105.28, "commercial": 159.21},
            {"date": "2025-05-06", "roofmaxx_kc": 187.85, "kc_restoration": 127.36, "storm_damage": 190.63, "maintenance": 94.63, "commercial": 144.32},
            {"date": "2025-05-07", "roofmaxx_kc": 193.49, "kc_restoration": 109.41, "storm_damage": 239.63, "maintenance": 94.21, "commercial": 123.44},
            {"date": "2025-05-08", "roofmaxx_kc": 166.94, "kc_restoration": 141.61, "storm_damage": 217.36, "maintenance": 104.33, "commercial": 146.44},
            {"date": "2025-05-09", "roofmaxx_kc": 162.21, "kc_restoration": 141.04, "storm_damage": 239.17, "maintenance": 89.91, "commercial": 119.66},
            {"date": "2025-05-10", "roofmaxx_kc": 129.93, "kc_restoration": 69.11, "storm_damage": 129.69, "maintenance": 70.02, "commercial": 80.75}
        ];

        // Chart setup
        const margin = { top: 20, right: 60, bottom: 60, left: 60 };
        const width = 1100 - margin.left - margin.right;
        const height = 400 - margin.top - margin.bottom;

        const colors = ['#5F8DFF', '#5DD6C7', '#FFB366', '#B794F6', '#7BA4FF'];
        
        const parseTime = d3.timeParse("%Y-%m-%d");
        const formatTime = d3.timeFormat("%b %d");

        // Process data
        const processedData = data.map(d => ({
            date: parseTime(d.date),
            roofmaxx_kc: +d.roofmaxx_kc,
            kc_restoration: +d.kc_restoration,
            storm_damage: +d.storm_damage,
            maintenance: +d.maintenance,
            commercial: +d.commercial
        }));

        const seriesKeys = Object.keys(data[0]).filter(key => key !== 'date');
        const series = seriesKeys.map((key, i) => ({
            name: key,
            displayName: key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
            color: colors[i],
            visible: true,
            values: processedData.map(d => ({ date: d.date, value: d[key] }))
        }));

        // Create SVG
        const svg = d3.select("#chart")
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // Scales
        const xScale = d3.scaleTime()
            .domain(d3.extent(processedData, d => d.date))
            .range([0, width]);

        const yScale = d3.scaleLinear()
            .domain([0, d3.max(series, s => d3.max(s.values, d => d.value))])
            .nice()
            .range([height, 0]);

        // Line generator
        const line = d3.line()
            .x(d => xScale(d.date))
            .y(d => yScale(d.value))
            .curve(d3.curveMonotoneX);

        // Add grid
        svg.append("g")
            .attr("class", "grid")
            .selectAll("line")
            .data(yScale.ticks())
            .enter().append("line")
            .attr("class", "grid-line")
            .attr("x1", 0)
            .attr("x2", width)
            .attr("y1", d => yScale(d))
            .attr("y2", d => yScale(d));

        // Add axes
        svg.append("g")
            .attr("class", "axis")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(xScale).tickFormat(formatTime));

        svg.append("g")
            .attr("class", "axis")
            .call(d3.axisLeft(yScale));

        // Add lines
        series.forEach((s, i) => {
            svg.append("path")
                .datum(s.values)
                .attr("class", "line")
                .attr("id", `line-${i}`)
                .attr("d", line)
                .style("stroke", s.color)
                .style("opacity", s.visible ? 1 : 0);
        });

        // Create legend
        const legend = d3.select("#legend");
        series.forEach((s, i) => {
            const item = legend.append("div")
                .attr("class", "legend-item")
                .style("cursor", "pointer")
                .on("click", () => {
                    s.visible = !s.visible;
                    d3.select(`#line-${i}`).style("opacity", s.visible ? 1 : 0);
                    item.style("opacity", s.visible ? 1 : 0.5);
                });

            item.append("div")
                .attr("class", "legend-color")
                .style("background", s.color);

            item.append("span")
                .attr("class", "legend-label")
                .text(s.displayName);
        });

        console.log("üìä Simple Google Ads chart loaded successfully!");
    </script>
</body>
</html>